from __future__ import unicode_literals

import re
import sys
import types

from django.conf import settings
from django.http import HttpResponse, HttpResponseNotFound
from django.template import Context, Engine, TemplateDoesNotExist
from django.template.defaultfilters import force_escape, pprint
from django.urls import Resolver404, resolve
from django.utils import lru_cache, six, timezone
from django.utils.datastructures import MultiValueDict
from django.utils.encoding import force_bytes, force_text
from django.utils.module_loading import import_string
from django.utils.translation import ugettext as _

# Minimal Django templates engine to render the error templates
# regardless of the project's TEMPLATES setting.
DEBUG_ENGINE = Engine(debug=True)

HIDDEN_SETTINGS = re.compile('API|TOKEN|KEY|SECRET|PASS|SIGNATURE', flags=re.IGNORECASE)

CLEANSED_SUBSTITUTE = '********************'


class CallableSettingWrapper(object):
    """ Object to wrap callable appearing in settings

    * Not to call in the debug page (#21345).
    * Not to break the debug page if the callable forbidding to set attributes (#23070).
    """
    def __init__(self, callable_setting):
        self._wrapped = callable_setting

    def __repr__(self):
        return repr(self._wrapped)


def cleanse_setting(key, value):
    """Cleanse an individual setting key/value of sensitive content.

    If the value is a dictionary, recursively cleanse the keys in
    that dictionary.
    """
    try:
        if HIDDEN_SETTINGS.search(key):
            cleansed = CLEANSED_SUBSTITUTE
        else:
            if isinstance(value, dict):
                cleansed = ***REMOVED***k: cleanse_setting(k, v) for k, v in value.items()***REMOVED***
            else:
                cleansed = value
    except TypeError:
        # If the key isn't regex-able, just return as-is.
        cleansed = value

    if callable(cleansed):
        # For fixing #21345 and #23070
        cleansed = CallableSettingWrapper(cleansed)

    return cleansed


def get_safe_settings():
    "Returns a dictionary of the settings module, with sensitive settings blurred out."
    settings_dict = ***REMOVED******REMOVED***
    for k in dir(settings):
        if k.isupper():
            settings_dict[k] = cleanse_setting(k, getattr(settings, k))
    return settings_dict


def technical_500_response(request, exc_type, exc_value, tb, status_code=500):
    """
    Create a technical server error response. The last three arguments are
    the values returned from sys.exc_info() and friends.
    """
    reporter = ExceptionReporter(request, exc_type, exc_value, tb)
    if request.is_ajax():
        text = reporter.get_traceback_text()
        return HttpResponse(text, status=status_code, content_type='text/plain')
    else:
        html = reporter.get_traceback_html()
        return HttpResponse(html, status=status_code, content_type='text/html')


@lru_cache.lru_cache()
def get_default_exception_reporter_filter():
    # Instantiate the default filter for the first time and cache it.
    return import_string(settings.DEFAULT_EXCEPTION_REPORTER_FILTER)()


def get_exception_reporter_filter(request):
    default_filter = get_default_exception_reporter_filter()
    return getattr(request, 'exception_reporter_filter', default_filter)


class ExceptionReporterFilter(object):
    """
    Base for all exception reporter filter classes. All overridable hooks
    contain lenient default behaviors.
    """

    def get_post_parameters(self, request):
        if request is None:
            return ***REMOVED******REMOVED***
        else:
            return request.POST

    def get_traceback_frame_variables(self, request, tb_frame):
        return list(tb_frame.f_locals.items())


class SafeExceptionReporterFilter(ExceptionReporterFilter):
    """
    Use annotations made by the sensitive_post_parameters and
    sensitive_variables decorators to filter out sensitive information.
    """

    def is_active(self, request):
        """
        This filter is to add safety in production environments (i.e. DEBUG
        is False). If DEBUG is True then your site is not safe anyway.
        This hook is provided as a convenience to easily activate or
        deactivate the filter on a per request basis.
        """
        return settings.DEBUG is False

    def get_cleansed_multivaluedict(self, request, multivaluedict):
        """
        Replaces the keys in a MultiValueDict marked as sensitive with stars.
        This mitigates leaking sensitive POST parameters if something like
        request.POST['nonexistent_key'] throws an exception (#21098).
        """
        sensitive_post_parameters = getattr(request, 'sensitive_post_parameters', [])
        if self.is_active(request) and sensitive_post_parameters:
            multivaluedict = multivaluedict.copy()
            for param in sensitive_post_parameters:
                if param in multivaluedict:
                    multivaluedict[param] = CLEANSED_SUBSTITUTE
        return multivaluedict

    def get_post_parameters(self, request):
        """
        Replaces the values of POST parameters marked as sensitive with
        stars (*********).
        """
        if request is None:
            return ***REMOVED******REMOVED***
        else:
            sensitive_post_parameters = getattr(request, 'sensitive_post_parameters', [])
            if self.is_active(request) and sensitive_post_parameters:
                cleansed = request.POST.copy()
                if sensitive_post_parameters == '__ALL__':
                    # Cleanse all parameters.
                    for k, v in cleansed.items():
                        cleansed[k] = CLEANSED_SUBSTITUTE
                    return cleansed
                else:
                    # Cleanse only the specified parameters.
                    for param in sensitive_post_parameters:
                        if param in cleansed:
                            cleansed[param] = CLEANSED_SUBSTITUTE
                    return cleansed
            else:
                return request.POST

    def cleanse_special_types(self, request, value):
        try:
            # If value is lazy or a complex object of another kind, this check
            # might raise an exception. isinstance checks that lazy
            # MultiValueDicts will have a return value.
            is_multivalue_dict = isinstance(value, MultiValueDict)
        except Exception as e:
            return '***REMOVED***!r***REMOVED*** while evaluating ***REMOVED***!r***REMOVED***'.format(e, value)

        if is_multivalue_dict:
            # Cleanse MultiValueDicts (request.POST is the one we usually care about)
            value = self.get_cleansed_multivaluedict(request, value)
        return value

    def get_traceback_frame_variables(self, request, tb_frame):
        """
        Replaces the values of variables marked as sensitive with
        stars (*********).
        """
        # Loop through the frame's callers to see if the sensitive_variables
        # decorator was used.
        current_frame = tb_frame.f_back
        sensitive_variables = None
        while current_frame is not None:
            if (current_frame.f_code.co_name == 'sensitive_variables_wrapper' and
                    'sensitive_variables_wrapper' in current_frame.f_locals):
                # The sensitive_variables decorator was used, so we take note
                # of the sensitive variables' names.
                wrapper = current_frame.f_locals['sensitive_variables_wrapper']
                sensitive_variables = getattr(wrapper, 'sensitive_variables', None)
                break
            current_frame = current_frame.f_back

        cleansed = ***REMOVED******REMOVED***
        if self.is_active(request) and sensitive_variables:
            if sensitive_variables == '__ALL__':
                # Cleanse all variables
                for name, value in tb_frame.f_locals.items():
                    cleansed[name] = CLEANSED_SUBSTITUTE
            else:
                # Cleanse specified variables
                for name, value in tb_frame.f_locals.items():
                    if name in sensitive_variables:
                        value = CLEANSED_SUBSTITUTE
                    else:
                        value = self.cleanse_special_types(request, value)
                    cleansed[name] = value
        else:
            # Potentially cleanse the request and any MultiValueDicts if they
            # are one of the frame variables.
            for name, value in tb_frame.f_locals.items():
                cleansed[name] = self.cleanse_special_types(request, value)

        if (tb_frame.f_code.co_name == 'sensitive_variables_wrapper' and
                'sensitive_variables_wrapper' in tb_frame.f_locals):
            # For good measure, obfuscate the decorated function's arguments in
            # the sensitive_variables decorator's frame, in case the variables
            # associated with those arguments were meant to be obfuscated from
            # the decorated function's frame.
            cleansed['func_args'] = CLEANSED_SUBSTITUTE
            cleansed['func_kwargs'] = CLEANSED_SUBSTITUTE

        return cleansed.items()


class ExceptionReporter(object):
    """
    A class to organize and coordinate reporting on exceptions.
    """
    def __init__(self, request, exc_type, exc_value, tb, is_email=False):
        self.request = request
        self.filter = get_exception_reporter_filter(self.request)
        self.exc_type = exc_type
        self.exc_value = exc_value
        self.tb = tb
        self.is_email = is_email

        self.template_info = getattr(self.exc_value, 'template_debug', None)
        self.template_does_not_exist = False
        self.postmortem = None

    def get_traceback_data(self):
        """Return a dictionary containing traceback information."""
        if self.exc_type and issubclass(self.exc_type, TemplateDoesNotExist):
            self.template_does_not_exist = True
            self.postmortem = self.exc_value.chain or [self.exc_value]

        frames = self.get_traceback_frames()
        for i, frame in enumerate(frames):
            if 'vars' in frame:
                frame_vars = []
                for k, v in frame['vars']:
                    v = pprint(v)
                    # The force_escape filter assume unicode, make sure that works
                    if isinstance(v, six.binary_type):
                        v = v.decode('utf-8', 'replace')  # don't choke on non-utf-8 input
                    # Trim large blobs of data
                    if len(v) > 4096:
                        v = '%s... <trimmed %d bytes string>' % (v[0:4096], len(v))
                    frame_vars.append((k, force_escape(v)))
                frame['vars'] = frame_vars
            frames[i] = frame

        unicode_hint = ''
        if self.exc_type and issubclass(self.exc_type, UnicodeError):
            start = getattr(self.exc_value, 'start', None)
            end = getattr(self.exc_value, 'end', None)
            if start is not None and end is not None:
                unicode_str = self.exc_value.args[1]
                unicode_hint = force_text(
                    unicode_str[max(start - 5, 0):min(end + 5, len(unicode_str))],
                    'ascii', errors='replace'
                )
        from django import get_version

        if self.request is None:
            user_str = None
        else:
            try:
                user_str = force_text(self.request.user)
            except Exception:
                # request.user may raise OperationalError if the database is
                # unavailable, for example.
                user_str = '[unable to retrieve the current user]'

        c = ***REMOVED***
            'is_email': self.is_email,
            'unicode_hint': unicode_hint,
            'frames': frames,
            'request': self.request,
            'user_str': user_str,
            'filtered_POST_items': list(self.filter.get_post_parameters(self.request).items()),
            'settings': get_safe_settings(),
            'sys_executable': sys.executable,
            'sys_version_info': '%d.%d.%d' % sys.version_info[0:3],
            'server_time': timezone.now(),
            'django_version_info': get_version(),
            'sys_path': sys.path,
            'template_info': self.template_info,
            'template_does_not_exist': self.template_does_not_exist,
            'postmortem': self.postmortem,
        ***REMOVED***
        if self.request is not None:
            c['request_GET_items'] = self.request.GET.items()
            c['request_FILES_items'] = self.request.FILES.items()
            c['request_COOKIES_items'] = self.request.COOKIES.items()
        # Check whether exception info is available
        if self.exc_type:
            c['exception_type'] = self.exc_type.__name__
        if self.exc_value:
            c['exception_value'] = force_text(self.exc_value, errors='replace')
        if frames:
            c['lastframe'] = frames[-1]
        return c

    def get_traceback_html(self):
        "Return HTML version of debug 500 HTTP error page."
        t = DEBUG_ENGINE.from_string(TECHNICAL_500_TEMPLATE)
        c = Context(self.get_traceback_data(), use_l10n=False)
        return t.render(c)

    def get_traceback_text(self):
        "Return plain text version of debug 500 HTTP error page."
        t = DEBUG_ENGINE.from_string(TECHNICAL_500_TEXT_TEMPLATE)
        c = Context(self.get_traceback_data(), autoescape=False, use_l10n=False)
        return t.render(c)

    def _get_lines_from_file(self, filename, lineno, context_lines, loader=None, module_name=None):
        """
        Returns context_lines before and after lineno from file.
        Returns (pre_context_lineno, pre_context, context_line, post_context).
        """
        source = None
        if loader is not None and hasattr(loader, "get_source"):
            try:
                source = loader.get_source(module_name)
            except ImportError:
                pass
            if source is not None:
                source = source.splitlines()
        if source is None:
            try:
                with open(filename, 'rb') as fp:
                    source = fp.read().splitlines()
            except (OSError, IOError):
                pass
        if source is None:
            return None, [], None, []

        # If we just read the source from a file, or if the loader did not
        # apply tokenize.detect_encoding to decode the source into a Unicode
        # string, then we should do that ourselves.
        if isinstance(source[0], six.binary_type):
            encoding = 'ascii'
            for line in source[:2]:
                # File coding may be specified. Match pattern from PEP-263
                # (http://www.python.org/dev/peps/pep-0263/)
                match = re.search(br'coding[:=]\s*([-\w.]+)', line)
                if match:
                    encoding = match.group(1).decode('ascii')
                    break
            source = [six.text_type(sline, encoding, 'replace') for sline in source]

        lower_bound = max(0, lineno - context_lines)
        upper_bound = lineno + context_lines

        pre_context = source[lower_bound:lineno]
        context_line = source[lineno]
        post_context = source[lineno + 1:upper_bound]

        return lower_bound, pre_context, context_line, post_context

    def get_traceback_frames(self):
        def explicit_or_implicit_cause(exc_value):
            explicit = getattr(exc_value, '__cause__', None)
            implicit = getattr(exc_value, '__context__', None)
            return explicit or implicit

        # Get the exception and all its causes
        exceptions = []
        exc_value = self.exc_value
        while exc_value:
            exceptions.append(exc_value)
            exc_value = explicit_or_implicit_cause(exc_value)

        frames = []
        # No exceptions were supplied to ExceptionReporter
        if not exceptions:
            return frames

        # In case there's just one exception (always in Python 2,
        # sometimes in Python 3), take the traceback from self.tb (Python 2
        # doesn't have a __traceback__ attribute on Exception)
        exc_value = exceptions.pop()
        tb = self.tb if six.PY2 or not exceptions else exc_value.__traceback__

        while tb is not None:
            # Support for __traceback_hide__ which is used by a few libraries
            # to hide internal frames.
            if tb.tb_frame.f_locals.get('__traceback_hide__'):
                tb = tb.tb_next
                continue
            filename = tb.tb_frame.f_code.co_filename
            function = tb.tb_frame.f_code.co_name
            lineno = tb.tb_lineno - 1
            loader = tb.tb_frame.f_globals.get('__loader__')
            module_name = tb.tb_frame.f_globals.get('__name__') or ''
            pre_context_lineno, pre_context, context_line, post_context = self._get_lines_from_file(
                filename, lineno, 7, loader, module_name,
            )
            if pre_context_lineno is not None:
                frames.append(***REMOVED***
                    'exc_cause': explicit_or_implicit_cause(exc_value),
                    'exc_cause_explicit': getattr(exc_value, '__cause__', True),
                    'tb': tb,
                    'type': 'django' if module_name.startswith('django.') else 'user',
                    'filename': filename,
                    'function': function,
                    'lineno': lineno + 1,
                    'vars': self.filter.get_traceback_frame_variables(self.request, tb.tb_frame),
                    'id': id(tb),
                    'pre_context': pre_context,
                    'context_line': context_line,
                    'post_context': post_context,
                    'pre_context_lineno': pre_context_lineno + 1,
                ***REMOVED***)

            # If the traceback for current exception is consumed, try the
            # other exception.
            if six.PY2:
                tb = tb.tb_next
            elif not tb.tb_next and exceptions:
                exc_value = exceptions.pop()
                tb = exc_value.__traceback__
            else:
                tb = tb.tb_next

        return frames

    def format_exception(self):
        """
        Return the same data as from traceback.format_exception.
        """
        import traceback
        frames = self.get_traceback_frames()
        tb = [(f['filename'], f['lineno'], f['function'], f['context_line']) for f in frames]
        list = ['Traceback (most recent call last):\n']
        list += traceback.format_list(tb)
        list += traceback.format_exception_only(self.exc_type, self.exc_value)
        return list


def technical_404_response(request, exception):
    "Create a technical 404 error response. The exception should be the Http404."
    try:
        error_url = exception.args[0]['path']
    except (IndexError, TypeError, KeyError):
        error_url = request.path_info[1:]  # Trim leading slash

    try:
        tried = exception.args[0]['tried']
    except (IndexError, TypeError, KeyError):
        tried = []
    else:
        if (not tried or (                  # empty URLconf
            request.path == '/' and
            len(tried) == 1 and             # default URLconf
            len(tried[0]) == 1 and
            getattr(tried[0][0], 'app_name', '') == getattr(tried[0][0], 'namespace', '') == 'admin'
        )):
            return default_urlconf(request)

    urlconf = getattr(request, 'urlconf', settings.ROOT_URLCONF)
    if isinstance(urlconf, types.ModuleType):
        urlconf = urlconf.__name__

    caller = ''
    try:
        resolver_match = resolve(request.path)
    except Resolver404:
        pass
    else:
        obj = resolver_match.func

        if hasattr(obj, '__name__'):
            caller = obj.__name__
        elif hasattr(obj, '__class__') and hasattr(obj.__class__, '__name__'):
            caller = obj.__class__.__name__

        if hasattr(obj, '__module__'):
            module = obj.__module__
            caller = '%s.%s' % (module, caller)

    t = DEBUG_ENGINE.from_string(TECHNICAL_404_TEMPLATE)
    c = Context(***REMOVED***
        'urlconf': urlconf,
        'root_urlconf': settings.ROOT_URLCONF,
        'request_path': error_url,
        'urlpatterns': tried,
        'reason': force_bytes(exception, errors='replace'),
        'request': request,
        'settings': get_safe_settings(),
        'raising_view_name': caller,
    ***REMOVED***)
    return HttpResponseNotFound(t.render(c), content_type='text/html')


def default_urlconf(request):
    "Create an empty URLconf 404 error response."
    t = DEBUG_ENGINE.from_string(DEFAULT_URLCONF_TEMPLATE)
    c = Context(***REMOVED***
        "title": _("Welcome to Django"),
        "heading": _("It worked!"),
        "subheading": _("Congratulations on your first Django-powered page."),
        "instructions": _(
            "Next, start your first app by running <code>python manage.py startapp [app_label]</code>."
        ),
        "explanation": _(
            "You're seeing this message because you have <code>DEBUG = True</code> in your "
            "Django settings file and you haven't configured any URLs. Get to work!"
        ),
    ***REMOVED***)

    return HttpResponse(t.render(c), content_type='text/html')


#
# Templates are embedded in the file so that we know the error handler will
# always work even if the template loader is broken.
#

TECHNICAL_500_TEMPLATE = ("""
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="robots" content="NONE,NOARCHIVE">
  <title>***REMOVED***% if exception_type %***REMOVED******REMOVED******REMOVED*** exception_type ***REMOVED******REMOVED******REMOVED***% else %***REMOVED***Report***REMOVED***% endif %***REMOVED***"""
r"""***REMOVED***% if request %***REMOVED*** at ***REMOVED******REMOVED*** request.path_info|escape ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***</title>
  <style type="text/css">
    html * ***REMOVED*** padding:0; margin:0; ***REMOVED***
    body * ***REMOVED*** padding:10px 20px; ***REMOVED***
    body * * ***REMOVED*** padding:0; ***REMOVED***
    body ***REMOVED*** font:small sans-serif; ***REMOVED***
    body>div ***REMOVED*** border-bottom:1px solid #ddd; ***REMOVED***
    h1 ***REMOVED*** font-weight:normal; ***REMOVED***
    h2 ***REMOVED*** margin-bottom:.8em; ***REMOVED***
    h2 span ***REMOVED*** font-size:80%; color:#666; font-weight:normal; ***REMOVED***
    h3 ***REMOVED*** margin:1em 0 .5em 0; ***REMOVED***
    h4 ***REMOVED*** margin:0 0 .5em 0; font-weight: normal; ***REMOVED***
    code, pre ***REMOVED*** font-size: 100%; white-space: pre-wrap; ***REMOVED***
    table ***REMOVED*** border:1px solid #ccc; border-collapse: collapse; width:100%; background:white; ***REMOVED***
    tbody td, tbody th ***REMOVED*** vertical-align:top; padding:2px 3px; ***REMOVED***
    thead th ***REMOVED***
      padding:1px 6px 1px 3px; background:#fefefe; text-align:left;
      font-weight:normal; font-size:11px; border:1px solid #ddd;
    ***REMOVED***
    tbody th ***REMOVED*** width:12em; text-align:right; color:#666; padding-right:.5em; ***REMOVED***
    table.vars ***REMOVED*** margin:5px 0 2px 40px; ***REMOVED***
    table.vars td, table.req td ***REMOVED*** font-family:monospace; ***REMOVED***
    table td.code ***REMOVED*** width:100%; ***REMOVED***
    table td.code pre ***REMOVED*** overflow:hidden; ***REMOVED***
    table.source th ***REMOVED*** color:#666; ***REMOVED***
    table.source td ***REMOVED*** font-family:monospace; white-space:pre; border-bottom:1px solid #eee; ***REMOVED***
    ul.traceback ***REMOVED*** list-style-type:none; color: #222; ***REMOVED***
    ul.traceback li.frame ***REMOVED*** padding-bottom:1em; color:#666; ***REMOVED***
    ul.traceback li.user ***REMOVED*** background-color:#e0e0e0; color:#000 ***REMOVED***
    div.context ***REMOVED*** padding:10px 0; overflow:hidden; ***REMOVED***
    div.context ol ***REMOVED*** padding-left:30px; margin:0 10px; list-style-position: inside; ***REMOVED***
    div.context ol li ***REMOVED*** font-family:monospace; white-space:pre; color:#777; cursor:pointer; padding-left: 2px; ***REMOVED***
    div.context ol li pre ***REMOVED*** display:inline; ***REMOVED***
    div.context ol.context-line li ***REMOVED*** color:#505050; background-color:#dfdfdf; padding: 3px 2px; ***REMOVED***
    div.context ol.context-line li span ***REMOVED*** position:absolute; right:32px; ***REMOVED***
    .user div.context ol.context-line li ***REMOVED*** background-color:#bbb; color:#000; ***REMOVED***
    .user div.context ol li ***REMOVED*** color:#666; ***REMOVED***
    div.commands ***REMOVED*** margin-left: 40px; ***REMOVED***
    div.commands a ***REMOVED*** color:#555; text-decoration:none; ***REMOVED***
    .user div.commands a ***REMOVED*** color: black; ***REMOVED***
    #summary ***REMOVED*** background: #ffc; ***REMOVED***
    #summary h2 ***REMOVED*** font-weight: normal; color: #666; ***REMOVED***
    #explanation ***REMOVED*** background:#eee; ***REMOVED***
    #template, #template-not-exist ***REMOVED*** background:#f6f6f6; ***REMOVED***
    #template-not-exist ul ***REMOVED*** margin: 0 0 10px 20px; ***REMOVED***
    #template-not-exist .postmortem-section ***REMOVED*** margin-bottom: 3px; ***REMOVED***
    #unicode-hint ***REMOVED*** background:#eee; ***REMOVED***
    #traceback ***REMOVED*** background:#eee; ***REMOVED***
    #requestinfo ***REMOVED*** background:#f6f6f6; padding-left:120px; ***REMOVED***
    #summary table ***REMOVED*** border:none; background:transparent; ***REMOVED***
    #requestinfo h2, #requestinfo h3 ***REMOVED*** position:relative; margin-left:-100px; ***REMOVED***
    #requestinfo h3 ***REMOVED*** margin-bottom:-1em; ***REMOVED***
    .error ***REMOVED*** background: #ffc; ***REMOVED***
    .specific ***REMOVED*** color:#cc3300; font-weight:bold; ***REMOVED***
    h2 span.commands ***REMOVED*** font-size:.7em;***REMOVED***
    span.commands a:link ***REMOVED***color:#5E5694;***REMOVED***
    pre.exception_value ***REMOVED*** font-family: sans-serif; color: #666; font-size: 1.5em; margin: 10px 0 10px 0; ***REMOVED***
    .append-bottom ***REMOVED*** margin-bottom: 10px; ***REMOVED***
  </style>
  ***REMOVED***% if not is_email %***REMOVED***
  <script type="text/javascript">
  //<!--
    function getElementsByClassName(oElm, strTagName, strClassName)***REMOVED***
        // Written by Jonathan Snook, http://www.snook.ca/jon; Add-ons by Robert Nyman, http://www.robertnyman.com
        var arrElements = (strTagName == "*" && document.all)? document.all :
        oElm.getElementsByTagName(strTagName);
        var arrReturnElements = new Array();
        strClassName = strClassName.replace(/\-/g, "\\-");
        var oRegExp = new RegExp("(^|\\s)" + strClassName + "(\\s|$)");
        var oElement;
        for(var i=0; i<arrElements.length; i++)***REMOVED***
            oElement = arrElements[i];
            if(oRegExp.test(oElement.className))***REMOVED***
                arrReturnElements.push(oElement);
            ***REMOVED***
        ***REMOVED***
        return (arrReturnElements)
    ***REMOVED***
    function hideAll(elems) ***REMOVED***
      for (var e = 0; e < elems.length; e++) ***REMOVED***
        elems[e].style.display = 'none';
      ***REMOVED***
    ***REMOVED***
    window.onload = function() ***REMOVED***
      hideAll(getElementsByClassName(document, 'table', 'vars'));
      hideAll(getElementsByClassName(document, 'ol', 'pre-context'));
      hideAll(getElementsByClassName(document, 'ol', 'post-context'));
      hideAll(getElementsByClassName(document, 'div', 'pastebin'));
    ***REMOVED***
    function toggle() ***REMOVED***
      for (var i = 0; i < arguments.length; i++) ***REMOVED***
        var e = document.getElementById(arguments[i]);
        if (e) ***REMOVED***
          e.style.display = e.style.display == 'none' ? 'block': 'none';
        ***REMOVED***
      ***REMOVED***
      return false;
    ***REMOVED***
    function varToggle(link, id) ***REMOVED***
      toggle('v' + id);
      var s = link.getElementsByTagName('span')[0];
      var uarr = String.fromCharCode(0x25b6);
      var darr = String.fromCharCode(0x25bc);
      s.textContent = s.textContent == uarr ? darr : uarr;
      return false;
    ***REMOVED***
    function switchPastebinFriendly(link) ***REMOVED***
      s1 = "Switch to copy-and-paste view";
      s2 = "Switch back to interactive view";
      link.textContent = link.textContent.trim() == s1 ? s2: s1;
      toggle('browserTraceback', 'pastebinTraceback');
      return false;
    ***REMOVED***
    //-->
  </script>
  ***REMOVED***% endif %***REMOVED***
</head>
<body>
<div id="summary">
  <h1>***REMOVED***% if exception_type %***REMOVED******REMOVED******REMOVED*** exception_type ***REMOVED******REMOVED******REMOVED***% else %***REMOVED***Report***REMOVED***% endif %***REMOVED***"""
  """***REMOVED***% if request %***REMOVED*** at ***REMOVED******REMOVED*** request.path_info|escape ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***</h1>
  <pre class="exception_value">"""
 """***REMOVED***% if exception_value %***REMOVED******REMOVED******REMOVED*** exception_value|force_escape ***REMOVED******REMOVED******REMOVED***% else %***REMOVED***No exception message supplied***REMOVED***% endif %***REMOVED***"""
"""</pre>
  <table class="meta">
***REMOVED***% if request %***REMOVED***
    <tr>
      <th>Request Method:</th>
      <td>***REMOVED******REMOVED*** request.META.REQUEST_METHOD ***REMOVED******REMOVED***</td>
    </tr>
    <tr>
      <th>Request URL:</th>
      <td>***REMOVED******REMOVED*** request.get_raw_uri|escape ***REMOVED******REMOVED***</td>
    </tr>
***REMOVED***% endif %***REMOVED***
    <tr>
      <th>Django Version:</th>
      <td>***REMOVED******REMOVED*** django_version_info ***REMOVED******REMOVED***</td>
    </tr>
***REMOVED***% if exception_type %***REMOVED***
    <tr>
      <th>Exception Type:</th>
      <td>***REMOVED******REMOVED*** exception_type ***REMOVED******REMOVED***</td>
    </tr>
***REMOVED***% endif %***REMOVED***
***REMOVED***% if exception_type and exception_value %***REMOVED***
    <tr>
      <th>Exception Value:</th>
      <td><pre>***REMOVED******REMOVED*** exception_value|force_escape ***REMOVED******REMOVED***</pre></td>
    </tr>
***REMOVED***% endif %***REMOVED***
***REMOVED***% if lastframe %***REMOVED***
    <tr>
      <th>Exception Location:</th>
      <td>***REMOVED******REMOVED*** lastframe.filename|escape ***REMOVED******REMOVED*** in ***REMOVED******REMOVED*** lastframe.function|escape ***REMOVED******REMOVED***, line ***REMOVED******REMOVED*** lastframe.lineno ***REMOVED******REMOVED***</td>
    </tr>
***REMOVED***% endif %***REMOVED***
    <tr>
      <th>Python Executable:</th>
      <td>***REMOVED******REMOVED*** sys_executable|escape ***REMOVED******REMOVED***</td>
    </tr>
    <tr>
      <th>Python Version:</th>
      <td>***REMOVED******REMOVED*** sys_version_info ***REMOVED******REMOVED***</td>
    </tr>
    <tr>
      <th>Python Path:</th>
      <td><pre>***REMOVED******REMOVED*** sys_path|pprint ***REMOVED******REMOVED***</pre></td>
    </tr>
    <tr>
      <th>Server time:</th>
      <td>***REMOVED******REMOVED***server_time|date:"r"***REMOVED******REMOVED***</td>
    </tr>
  </table>
</div>
***REMOVED***% if unicode_hint %***REMOVED***
<div id="unicode-hint">
    <h2>Unicode error hint</h2>
    <p>The string that could not be encoded/decoded was: <strong>***REMOVED******REMOVED*** unicode_hint|force_escape ***REMOVED******REMOVED***</strong></p>
</div>
***REMOVED***% endif %***REMOVED***
***REMOVED***% if template_does_not_exist %***REMOVED***
<div id="template-not-exist">
    <h2>Template-loader postmortem</h2>
    ***REMOVED***% if postmortem %***REMOVED***
        <p class="append-bottom">Django tried loading these templates, in this order:</p>
        ***REMOVED***% for entry in postmortem %***REMOVED***
            <p class="postmortem-section">Using engine <code>***REMOVED******REMOVED*** entry.backend.name ***REMOVED******REMOVED***</code>:</p>
            <ul>
                ***REMOVED***% if entry.tried %***REMOVED***
                    ***REMOVED***% for attempt in entry.tried %***REMOVED***
                        <li><code>***REMOVED******REMOVED*** attempt.0.loader_name ***REMOVED******REMOVED***</code>: ***REMOVED******REMOVED*** attempt.0.name ***REMOVED******REMOVED*** (***REMOVED******REMOVED*** attempt.1 ***REMOVED******REMOVED***)</li>
                    ***REMOVED***% endfor %***REMOVED***
                ***REMOVED***% else %***REMOVED***
                    <li>This engine did not provide a list of tried templates.</li>
                ***REMOVED***% endif %***REMOVED***
            </ul>
        ***REMOVED***% endfor %***REMOVED***
    ***REMOVED***% else %***REMOVED***
        <p>No templates were found because your 'TEMPLATES' setting is not configured.</p>
    ***REMOVED***% endif %***REMOVED***
</div>
***REMOVED***% endif %***REMOVED***
***REMOVED***% if template_info %***REMOVED***
<div id="template">
   <h2>Error during template rendering</h2>
   <p>In template <code>***REMOVED******REMOVED*** template_info.name ***REMOVED******REMOVED***</code>, error at line <strong>***REMOVED******REMOVED*** template_info.line ***REMOVED******REMOVED***</strong></p>
   <h3>***REMOVED******REMOVED*** template_info.message ***REMOVED******REMOVED***</h3>
   <table class="source***REMOVED***% if template_info.top %***REMOVED*** cut-top***REMOVED***% endif %***REMOVED***
      ***REMOVED***% if template_info.bottom != template_info.total %***REMOVED*** cut-bottom***REMOVED***% endif %***REMOVED***">
   ***REMOVED***% for source_line in template_info.source_lines %***REMOVED***
   ***REMOVED***% if source_line.0 == template_info.line %***REMOVED***
   <tr class="error"><th>***REMOVED******REMOVED*** source_line.0 ***REMOVED******REMOVED***</th>
     <td>***REMOVED******REMOVED*** template_info.before ***REMOVED******REMOVED***"""
      """<span class="specific">***REMOVED******REMOVED*** template_info.during ***REMOVED******REMOVED***</span>"""
      """***REMOVED******REMOVED*** template_info.after ***REMOVED******REMOVED***</td>
   </tr>
   ***REMOVED***% else %***REMOVED***
      <tr><th>***REMOVED******REMOVED*** source_line.0 ***REMOVED******REMOVED***</th>
      <td>***REMOVED******REMOVED*** source_line.1 ***REMOVED******REMOVED***</td></tr>
   ***REMOVED***% endif %***REMOVED***
   ***REMOVED***% endfor %***REMOVED***
   </table>
</div>
***REMOVED***% endif %***REMOVED***
***REMOVED***% if frames %***REMOVED***
<div id="traceback">
  <h2>Traceback <span class="commands">***REMOVED***% if not is_email %***REMOVED***<a href="#" onclick="return switchPastebinFriendly(this);">
    Switch to copy-and-paste view</a></span>***REMOVED***% endif %***REMOVED***
  </h2>
  <div id="browserTraceback">
    <ul class="traceback">
      ***REMOVED***% for frame in frames %***REMOVED***
        ***REMOVED***% ifchanged frame.exc_cause %***REMOVED******REMOVED***% if frame.exc_cause %***REMOVED***
          <li><h3>
          ***REMOVED***% if frame.exc_cause_explicit %***REMOVED***
            The above exception (***REMOVED******REMOVED*** frame.exc_cause|force_escape ***REMOVED******REMOVED***) was the direct cause of the following exception:
          ***REMOVED***% else %***REMOVED***
            During handling of the above exception (***REMOVED******REMOVED*** frame.exc_cause|force_escape ***REMOVED******REMOVED***), another exception occurred:
          ***REMOVED***% endif %***REMOVED***
        </h3></li>
        ***REMOVED***% endif %***REMOVED******REMOVED***% endifchanged %***REMOVED***
        <li class="frame ***REMOVED******REMOVED*** frame.type ***REMOVED******REMOVED***">
          <code>***REMOVED******REMOVED*** frame.filename ***REMOVED******REMOVED***</code> in <code>***REMOVED******REMOVED*** frame.function ***REMOVED******REMOVED***</code>

          ***REMOVED***% if frame.context_line %***REMOVED***
            <div class="context" id="c***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***">
              ***REMOVED***% if frame.pre_context and not is_email %***REMOVED***
                <ol start="***REMOVED******REMOVED*** frame.pre_context_lineno ***REMOVED******REMOVED***" class="pre-context" id="pre***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***">
                ***REMOVED***% for line in frame.pre_context %***REMOVED***
                  <li onclick="toggle('pre***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***', 'post***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***')"><pre>***REMOVED******REMOVED*** line ***REMOVED******REMOVED***</pre></li>
                ***REMOVED***% endfor %***REMOVED***
                </ol>
              ***REMOVED***% endif %***REMOVED***
              <ol start="***REMOVED******REMOVED*** frame.lineno ***REMOVED******REMOVED***" class="context-line">
                <li onclick="toggle('pre***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***', 'post***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***')"><pre>
"""            """***REMOVED******REMOVED*** frame.context_line ***REMOVED******REMOVED***</pre>***REMOVED***% if not is_email %***REMOVED*** <span>...</span>***REMOVED***% endif %***REMOVED***</li></ol>
              ***REMOVED***% if frame.post_context and not is_email  %***REMOVED***
                <ol start='***REMOVED******REMOVED*** frame.lineno|add:"1" ***REMOVED******REMOVED***' class="post-context" id="post***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***">
                  ***REMOVED***% for line in frame.post_context %***REMOVED***
                  <li onclick="toggle('pre***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***', 'post***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***')"><pre>***REMOVED******REMOVED*** line ***REMOVED******REMOVED***</pre></li>
                  ***REMOVED***% endfor %***REMOVED***
              </ol>
              ***REMOVED***% endif %***REMOVED***
            </div>
          ***REMOVED***% endif %***REMOVED***

          ***REMOVED***% if frame.vars %***REMOVED***
            <div class="commands">
                ***REMOVED***% if is_email %***REMOVED***
                    <h2>Local Vars</h2>
                ***REMOVED***% else %***REMOVED***
                    <a href="#" onclick="return varToggle(this, '***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***')"><span>&#x25b6;</span> Local vars</a>
                ***REMOVED***% endif %***REMOVED***
            </div>
            <table class="vars" id="v***REMOVED******REMOVED*** frame.id ***REMOVED******REMOVED***">
              <thead>
                <tr>
                  <th>Variable</th>
                  <th>Value</th>
                </tr>
              </thead>
              <tbody>
                ***REMOVED***% for var in frame.vars|dictsort:0 %***REMOVED***
                  <tr>
                    <td>***REMOVED******REMOVED*** var.0 ***REMOVED******REMOVED***</td>
                    <td class="code"><pre>***REMOVED******REMOVED*** var.1 ***REMOVED******REMOVED***</pre></td>
                  </tr>
                ***REMOVED***% endfor %***REMOVED***
              </tbody>
            </table>
          ***REMOVED***% endif %***REMOVED***
        </li>
      ***REMOVED***% endfor %***REMOVED***
    </ul>
  </div>
  <form action="http://dpaste.com/" name="pasteform" id="pasteform" method="post">
***REMOVED***% if not is_email %***REMOVED***
  <div id="pastebinTraceback" class="pastebin">
    <input type="hidden" name="language" value="PythonConsole">
    <input type="hidden" name="title"
      value="***REMOVED******REMOVED*** exception_type|escape ***REMOVED******REMOVED******REMOVED***% if request %***REMOVED*** at ***REMOVED******REMOVED*** request.path_info|escape ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***">
    <input type="hidden" name="source" value="Django Dpaste Agent">
    <input type="hidden" name="poster" value="Django">
    <textarea name="content" id="traceback_area" cols="140" rows="25">
Environment:

***REMOVED***% if request %***REMOVED***
Request Method: ***REMOVED******REMOVED*** request.META.REQUEST_METHOD ***REMOVED******REMOVED***
Request URL: ***REMOVED******REMOVED*** request.get_raw_uri|escape ***REMOVED******REMOVED***
***REMOVED***% endif %***REMOVED***
Django Version: ***REMOVED******REMOVED*** django_version_info ***REMOVED******REMOVED***
Python Version: ***REMOVED******REMOVED*** sys_version_info ***REMOVED******REMOVED***
Installed Applications:
***REMOVED******REMOVED*** settings.INSTALLED_APPS|pprint ***REMOVED******REMOVED***
Installed Middleware:
***REMOVED***% if settings.MIDDLEWARE is not None %***REMOVED******REMOVED******REMOVED*** settings.MIDDLEWARE|pprint ***REMOVED******REMOVED***"""
"""***REMOVED***% else %***REMOVED******REMOVED******REMOVED*** settings.MIDDLEWARE_CLASSES|pprint ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***

***REMOVED***% if template_does_not_exist %***REMOVED***Template loader postmortem
***REMOVED***% if postmortem %***REMOVED***Django tried loading these templates, in this order:
***REMOVED***% for entry in postmortem %***REMOVED***
Using engine ***REMOVED******REMOVED*** entry.backend.name ***REMOVED******REMOVED***:
***REMOVED***% if entry.tried %***REMOVED******REMOVED***% for attempt in entry.tried %***REMOVED***"""
"""    * ***REMOVED******REMOVED*** attempt.0.loader_name ***REMOVED******REMOVED***: ***REMOVED******REMOVED*** attempt.0.name ***REMOVED******REMOVED*** (***REMOVED******REMOVED*** attempt.1 ***REMOVED******REMOVED***)
***REMOVED***% endfor %***REMOVED******REMOVED***% else %***REMOVED***    This engine did not provide a list of tried templates.
***REMOVED***% endif %***REMOVED******REMOVED***% endfor %***REMOVED***
***REMOVED***% else %***REMOVED***No templates were found because your 'TEMPLATES' setting is not configured.
***REMOVED***% endif %***REMOVED******REMOVED***% endif %***REMOVED******REMOVED***% if template_info %***REMOVED***
Template error:
In template ***REMOVED******REMOVED*** template_info.name ***REMOVED******REMOVED***, error at line ***REMOVED******REMOVED*** template_info.line ***REMOVED******REMOVED***
   ***REMOVED******REMOVED*** template_info.message ***REMOVED******REMOVED***"""
"***REMOVED***% for source_line in template_info.source_lines %***REMOVED***"
"***REMOVED***% if source_line.0 == template_info.line %***REMOVED***"
"   ***REMOVED******REMOVED*** source_line.0 ***REMOVED******REMOVED*** : ***REMOVED******REMOVED*** template_info.before ***REMOVED******REMOVED*** ***REMOVED******REMOVED*** template_info.during ***REMOVED******REMOVED*** ***REMOVED******REMOVED*** template_info.after ***REMOVED******REMOVED***"
"***REMOVED***% else %***REMOVED***"
"   ***REMOVED******REMOVED*** source_line.0 ***REMOVED******REMOVED*** : ***REMOVED******REMOVED*** source_line.1 ***REMOVED******REMOVED***"
"""***REMOVED***% endif %***REMOVED******REMOVED***% endfor %***REMOVED******REMOVED***% endif %***REMOVED***

Traceback:***REMOVED***% for frame in frames %***REMOVED***
***REMOVED***% ifchanged frame.exc_cause %***REMOVED******REMOVED***% if frame.exc_cause %***REMOVED******REMOVED***% if frame.exc_cause_explicit %***REMOVED***
The above exception (***REMOVED******REMOVED*** frame.exc_cause|force_escape ***REMOVED******REMOVED***) was the direct cause of the following exception:
***REMOVED***% else %***REMOVED***
During handling of the above exception (***REMOVED******REMOVED*** frame.exc_cause|force_escape ***REMOVED******REMOVED***), another exception occurred:
***REMOVED***% endif %***REMOVED******REMOVED***% endif %***REMOVED******REMOVED***% endifchanged %***REMOVED***
File "***REMOVED******REMOVED*** frame.filename|escape ***REMOVED******REMOVED***" in ***REMOVED******REMOVED*** frame.function|escape ***REMOVED******REMOVED***
***REMOVED***% if frame.context_line %***REMOVED***  ***REMOVED******REMOVED*** frame.lineno ***REMOVED******REMOVED***. ***REMOVED******REMOVED*** frame.context_line|escape ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED******REMOVED***% endfor %***REMOVED***

Exception Type: ***REMOVED******REMOVED*** exception_type|escape ***REMOVED******REMOVED******REMOVED***% if request %***REMOVED*** at ***REMOVED******REMOVED*** request.path_info|escape ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***
Exception Value: ***REMOVED******REMOVED*** exception_value|force_escape ***REMOVED******REMOVED***
</textarea>
  <br><br>
  <input type="submit" value="Share this traceback on a public website">
  </div>
</form>
</div>
***REMOVED***% endif %***REMOVED***
***REMOVED***% endif %***REMOVED***

<div id="requestinfo">
  <h2>Request information</h2>

***REMOVED***% if request %***REMOVED***
  ***REMOVED***% if user_str %***REMOVED***
    <h3 id="user-info">USER</h3>
    <p>***REMOVED******REMOVED*** user_str ***REMOVED******REMOVED***</p>
  ***REMOVED***% endif %***REMOVED***

  <h3 id="get-info">GET</h3>
  ***REMOVED***% if request.GET %***REMOVED***
    <table class="req">
      <thead>
        <tr>
          <th>Variable</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        ***REMOVED***% for k, v in request_GET_items %***REMOVED***
          <tr>
            <td>***REMOVED******REMOVED*** k ***REMOVED******REMOVED***</td>
            <td class="code"><pre>***REMOVED******REMOVED*** v|pprint ***REMOVED******REMOVED***</pre></td>
          </tr>
        ***REMOVED***% endfor %***REMOVED***
      </tbody>
    </table>
  ***REMOVED***% else %***REMOVED***
    <p>No GET data</p>
  ***REMOVED***% endif %***REMOVED***

  <h3 id="post-info">POST</h3>
  ***REMOVED***% if filtered_POST_items %***REMOVED***
    <table class="req">
      <thead>
        <tr>
          <th>Variable</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        ***REMOVED***% for k, v in filtered_POST_items %***REMOVED***
          <tr>
            <td>***REMOVED******REMOVED*** k ***REMOVED******REMOVED***</td>
            <td class="code"><pre>***REMOVED******REMOVED*** v|pprint ***REMOVED******REMOVED***</pre></td>
          </tr>
        ***REMOVED***% endfor %***REMOVED***
      </tbody>
    </table>
  ***REMOVED***% else %***REMOVED***
    <p>No POST data</p>
  ***REMOVED***% endif %***REMOVED***
  <h3 id="files-info">FILES</h3>
  ***REMOVED***% if request.FILES %***REMOVED***
    <table class="req">
        <thead>
            <tr>
                <th>Variable</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
            ***REMOVED***% for k, v in request_FILES_items %***REMOVED***
                <tr>
                    <td>***REMOVED******REMOVED*** k ***REMOVED******REMOVED***</td>
                    <td class="code"><pre>***REMOVED******REMOVED*** v|pprint ***REMOVED******REMOVED***</pre></td>
                </tr>
            ***REMOVED***% endfor %***REMOVED***
        </tbody>
    </table>
  ***REMOVED***% else %***REMOVED***
    <p>No FILES data</p>
  ***REMOVED***% endif %***REMOVED***


  <h3 id="cookie-info">COOKIES</h3>
  ***REMOVED***% if request.COOKIES %***REMOVED***
    <table class="req">
      <thead>
        <tr>
          <th>Variable</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        ***REMOVED***% for k, v in request_COOKIES_items %***REMOVED***
          <tr>
            <td>***REMOVED******REMOVED*** k ***REMOVED******REMOVED***</td>
            <td class="code"><pre>***REMOVED******REMOVED*** v|pprint ***REMOVED******REMOVED***</pre></td>
          </tr>
        ***REMOVED***% endfor %***REMOVED***
      </tbody>
    </table>
  ***REMOVED***% else %***REMOVED***
    <p>No cookie data</p>
  ***REMOVED***% endif %***REMOVED***

  <h3 id="meta-info">META</h3>
  <table class="req">
    <thead>
      <tr>
        <th>Variable</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      ***REMOVED***% for var in request.META.items|dictsort:0 %***REMOVED***
        <tr>
          <td>***REMOVED******REMOVED*** var.0 ***REMOVED******REMOVED***</td>
          <td class="code"><pre>***REMOVED******REMOVED*** var.1|pprint ***REMOVED******REMOVED***</pre></td>
        </tr>
      ***REMOVED***% endfor %***REMOVED***
    </tbody>
  </table>
***REMOVED***% else %***REMOVED***
  <p>Request data not supplied</p>
***REMOVED***% endif %***REMOVED***

  <h3 id="settings-info">Settings</h3>
  <h4>Using settings module <code>***REMOVED******REMOVED*** settings.SETTINGS_MODULE ***REMOVED******REMOVED***</code></h4>
  <table class="req">
    <thead>
      <tr>
        <th>Setting</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      ***REMOVED***% for var in settings.items|dictsort:0 %***REMOVED***
        <tr>
          <td>***REMOVED******REMOVED*** var.0 ***REMOVED******REMOVED***</td>
          <td class="code"><pre>***REMOVED******REMOVED*** var.1|pprint ***REMOVED******REMOVED***</pre></td>
        </tr>
      ***REMOVED***% endfor %***REMOVED***
    </tbody>
  </table>

</div>
***REMOVED***% if not is_email %***REMOVED***
  <div id="explanation">
    <p>
      You're seeing this error because you have <code>DEBUG = True</code> in your
      Django settings file. Change that to <code>False</code>, and Django will
      display a standard page generated by the handler for this status code.
    </p>
  </div>
***REMOVED***% endif %***REMOVED***
</body>
</html>
""")  # NOQA

TECHNICAL_500_TEXT_TEMPLATE = (""""""
"""***REMOVED***% firstof exception_type 'Report' %***REMOVED******REMOVED***% if request %***REMOVED*** at ***REMOVED******REMOVED*** request.path_info ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***
***REMOVED***% firstof exception_value 'No exception message supplied' %***REMOVED***
***REMOVED***% if request %***REMOVED***
Request Method: ***REMOVED******REMOVED*** request.META.REQUEST_METHOD ***REMOVED******REMOVED***
Request URL: ***REMOVED******REMOVED*** request.get_raw_uri ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***
Django Version: ***REMOVED******REMOVED*** django_version_info ***REMOVED******REMOVED***
Python Executable: ***REMOVED******REMOVED*** sys_executable ***REMOVED******REMOVED***
Python Version: ***REMOVED******REMOVED*** sys_version_info ***REMOVED******REMOVED***
Python Path: ***REMOVED******REMOVED*** sys_path ***REMOVED******REMOVED***
Server time: ***REMOVED******REMOVED***server_time|date:"r"***REMOVED******REMOVED***
Installed Applications:
***REMOVED******REMOVED*** settings.INSTALLED_APPS|pprint ***REMOVED******REMOVED***
Installed Middleware:
***REMOVED***% if settings.MIDDLEWARE is not None %***REMOVED******REMOVED******REMOVED*** settings.MIDDLEWARE|pprint ***REMOVED******REMOVED***"""
"""***REMOVED***% else %***REMOVED******REMOVED******REMOVED*** settings.MIDDLEWARE_CLASSES|pprint ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***
***REMOVED***% if template_does_not_exist %***REMOVED***Template loader postmortem
***REMOVED***% if postmortem %***REMOVED***Django tried loading these templates, in this order:
***REMOVED***% for entry in postmortem %***REMOVED***
Using engine ***REMOVED******REMOVED*** entry.backend.name ***REMOVED******REMOVED***:
***REMOVED***% if entry.tried %***REMOVED******REMOVED***% for attempt in entry.tried %***REMOVED***"""
"""    * ***REMOVED******REMOVED*** attempt.0.loader_name ***REMOVED******REMOVED***: ***REMOVED******REMOVED*** attempt.0.name ***REMOVED******REMOVED*** (***REMOVED******REMOVED*** attempt.1 ***REMOVED******REMOVED***)
***REMOVED***% endfor %***REMOVED******REMOVED***% else %***REMOVED***    This engine did not provide a list of tried templates.
***REMOVED***% endif %***REMOVED******REMOVED***% endfor %***REMOVED***
***REMOVED***% else %***REMOVED***No templates were found because your 'TEMPLATES' setting is not configured.
***REMOVED***% endif %***REMOVED***
***REMOVED***% endif %***REMOVED******REMOVED***% if template_info %***REMOVED***
Template error:
In template ***REMOVED******REMOVED*** template_info.name ***REMOVED******REMOVED***, error at line ***REMOVED******REMOVED*** template_info.line ***REMOVED******REMOVED***
   ***REMOVED******REMOVED*** template_info.message ***REMOVED******REMOVED***
***REMOVED***% for source_line in template_info.source_lines %***REMOVED***"""
"***REMOVED***% if source_line.0 == template_info.line %***REMOVED***"
"   ***REMOVED******REMOVED*** source_line.0 ***REMOVED******REMOVED*** : ***REMOVED******REMOVED*** template_info.before ***REMOVED******REMOVED*** ***REMOVED******REMOVED*** template_info.during ***REMOVED******REMOVED*** ***REMOVED******REMOVED*** template_info.after ***REMOVED******REMOVED***"
"***REMOVED***% else %***REMOVED***"
"   ***REMOVED******REMOVED*** source_line.0 ***REMOVED******REMOVED*** : ***REMOVED******REMOVED*** source_line.1 ***REMOVED******REMOVED***"
"""***REMOVED***% endif %***REMOVED******REMOVED***% endfor %***REMOVED******REMOVED***% endif %***REMOVED******REMOVED***% if frames %***REMOVED***

Traceback:"""
"***REMOVED***% for frame in frames %***REMOVED***"
"***REMOVED***% ifchanged frame.exc_cause %***REMOVED***"
"  ***REMOVED***% if frame.exc_cause %***REMOVED***" """
    ***REMOVED***% if frame.exc_cause_explicit %***REMOVED***
      The above exception (***REMOVED******REMOVED*** frame.exc_cause ***REMOVED******REMOVED***) was the direct cause of the following exception:
    ***REMOVED***% else %***REMOVED***
      During handling of the above exception (***REMOVED******REMOVED*** frame.exc_cause ***REMOVED******REMOVED***), another exception occurred:
    ***REMOVED***% endif %***REMOVED***
  ***REMOVED***% endif %***REMOVED***
***REMOVED***% endifchanged %***REMOVED***
File "***REMOVED******REMOVED*** frame.filename ***REMOVED******REMOVED***" in ***REMOVED******REMOVED*** frame.function ***REMOVED******REMOVED***
***REMOVED***% if frame.context_line %***REMOVED***  ***REMOVED******REMOVED*** frame.lineno ***REMOVED******REMOVED***. ***REMOVED******REMOVED*** frame.context_line ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***
***REMOVED***% endfor %***REMOVED***
***REMOVED***% if exception_type %***REMOVED***Exception Type: ***REMOVED******REMOVED*** exception_type ***REMOVED******REMOVED******REMOVED***% if request %***REMOVED*** at ***REMOVED******REMOVED*** request.path_info ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***
***REMOVED***% if exception_value %***REMOVED***Exception Value: ***REMOVED******REMOVED*** exception_value ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED******REMOVED***% endif %***REMOVED******REMOVED***% endif %***REMOVED***
***REMOVED***% if request %***REMOVED***Request information:
***REMOVED***% if user_str %***REMOVED***USER: ***REMOVED******REMOVED*** user_str ***REMOVED******REMOVED******REMOVED***% endif %***REMOVED***

GET:***REMOVED***% for k, v in request_GET_items %***REMOVED***
***REMOVED******REMOVED*** k ***REMOVED******REMOVED*** = ***REMOVED******REMOVED*** v|stringformat:"r" ***REMOVED******REMOVED******REMOVED***% empty %***REMOVED*** No GET data***REMOVED***% endfor %***REMOVED***

POST:***REMOVED***% for k, v in filtered_POST_items %***REMOVED***
***REMOVED******REMOVED*** k ***REMOVED******REMOVED*** = ***REMOVED******REMOVED*** v|stringformat:"r" ***REMOVED******REMOVED******REMOVED***% empty %***REMOVED*** No POST data***REMOVED***% endfor %***REMOVED***

FILES:***REMOVED***% for k, v in request_FILES_items %***REMOVED***
***REMOVED******REMOVED*** k ***REMOVED******REMOVED*** = ***REMOVED******REMOVED*** v|stringformat:"r" ***REMOVED******REMOVED******REMOVED***% empty %***REMOVED*** No FILES data***REMOVED***% endfor %***REMOVED***

COOKIES:***REMOVED***% for k, v in request_COOKIES_items %***REMOVED***
***REMOVED******REMOVED*** k ***REMOVED******REMOVED*** = ***REMOVED******REMOVED*** v|stringformat:"r" ***REMOVED******REMOVED******REMOVED***% empty %***REMOVED*** No cookie data***REMOVED***% endfor %***REMOVED***

META:***REMOVED***% for k, v in request.META.items|dictsort:0 %***REMOVED***
***REMOVED******REMOVED*** k ***REMOVED******REMOVED*** = ***REMOVED******REMOVED*** v|stringformat:"r" ***REMOVED******REMOVED******REMOVED***% endfor %***REMOVED***
***REMOVED***% else %***REMOVED***Request data not supplied
***REMOVED***% endif %***REMOVED***
Settings:
Using settings module ***REMOVED******REMOVED*** settings.SETTINGS_MODULE ***REMOVED******REMOVED******REMOVED***% for k, v in settings.items|dictsort:0 %***REMOVED***
***REMOVED******REMOVED*** k ***REMOVED******REMOVED*** = ***REMOVED******REMOVED*** v|stringformat:"r" ***REMOVED******REMOVED******REMOVED***% endfor %***REMOVED***

***REMOVED***% if not is_email %***REMOVED***
You're seeing this error because you have DEBUG = True in your
Django settings file. Change that to False, and Django will
display a standard page generated by the handler for this status code.
***REMOVED***% endif %***REMOVED***
""")  # NOQA

TECHNICAL_404_TEMPLATE = """
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Page not found at ***REMOVED******REMOVED*** request.path_info|escape ***REMOVED******REMOVED***</title>
  <meta name="robots" content="NONE,NOARCHIVE">
  <style type="text/css">
    html * ***REMOVED*** padding:0; margin:0; ***REMOVED***
    body * ***REMOVED*** padding:10px 20px; ***REMOVED***
    body * * ***REMOVED*** padding:0; ***REMOVED***
    body ***REMOVED*** font:small sans-serif; background:#eee; ***REMOVED***
    body>div ***REMOVED*** border-bottom:1px solid #ddd; ***REMOVED***
    h1 ***REMOVED*** font-weight:normal; margin-bottom:.4em; ***REMOVED***
    h1 span ***REMOVED*** font-size:60%; color:#666; font-weight:normal; ***REMOVED***
    table ***REMOVED*** border:none; border-collapse: collapse; width:100%; ***REMOVED***
    td, th ***REMOVED*** vertical-align:top; padding:2px 3px; ***REMOVED***
    th ***REMOVED*** width:12em; text-align:right; color:#666; padding-right:.5em; ***REMOVED***
    #info ***REMOVED*** background:#f6f6f6; ***REMOVED***
    #info ol ***REMOVED*** margin: 0.5em 4em; ***REMOVED***
    #info ol li ***REMOVED*** font-family: monospace; ***REMOVED***
    #summary ***REMOVED*** background: #ffc; ***REMOVED***
    #explanation ***REMOVED*** background:#eee; border-bottom: 0px none; ***REMOVED***
  </style>
</head>
<body>
  <div id="summary">
    <h1>Page not found <span>(404)</span></h1>
    <table class="meta">
      <tr>
        <th>Request Method:</th>
        <td>***REMOVED******REMOVED*** request.META.REQUEST_METHOD ***REMOVED******REMOVED***</td>
      </tr>
      <tr>
        <th>Request URL:</th>
        <td>***REMOVED******REMOVED*** request.build_absolute_uri|escape ***REMOVED******REMOVED***</td>
      </tr>
      ***REMOVED***% if raising_view_name %***REMOVED***
      <tr>
        <th>Raised by:</th>
        <td>***REMOVED******REMOVED*** raising_view_name ***REMOVED******REMOVED***</td>
      </tr>
      ***REMOVED***% endif %***REMOVED***
    </table>
  </div>
  <div id="info">
    ***REMOVED***% if urlpatterns %***REMOVED***
      <p>
      Using the URLconf defined in <code>***REMOVED******REMOVED*** urlconf ***REMOVED******REMOVED***</code>,
      Django tried these URL patterns, in this order:
      </p>
      <ol>
        ***REMOVED***% for pattern in urlpatterns %***REMOVED***
          <li>
            ***REMOVED***% for pat in pattern %***REMOVED***
                ***REMOVED******REMOVED*** pat.regex.pattern ***REMOVED******REMOVED***
                ***REMOVED***% if forloop.last and pat.name %***REMOVED***[name='***REMOVED******REMOVED*** pat.name ***REMOVED******REMOVED***']***REMOVED***% endif %***REMOVED***
            ***REMOVED***% endfor %***REMOVED***
          </li>
        ***REMOVED***% endfor %***REMOVED***
      </ol>
      <p>
        ***REMOVED***% if request_path %***REMOVED***
        The current path, <code>***REMOVED******REMOVED*** request_path|escape ***REMOVED******REMOVED***</code>,***REMOVED***% else %***REMOVED***
        The empty path***REMOVED***% endif %***REMOVED*** didn't match any of these.
      </p>
    ***REMOVED***% else %***REMOVED***
      <p>***REMOVED******REMOVED*** reason ***REMOVED******REMOVED***</p>
    ***REMOVED***% endif %***REMOVED***
  </div>

  <div id="explanation">
    <p>
      You're seeing this error because you have <code>DEBUG = True</code> in
      your Django settings file. Change that to <code>False</code>, and Django
      will display a standard 404 page.
    </p>
  </div>
</body>
</html>
"""

DEFAULT_URLCONF_TEMPLATE = """
<!DOCTYPE html>
<html lang="en"><head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="robots" content="NONE,NOARCHIVE"><title>***REMOVED******REMOVED*** title ***REMOVED******REMOVED***</title>
  <style type="text/css">
    html * ***REMOVED*** padding:0; margin:0; ***REMOVED***
    body * ***REMOVED*** padding:10px 20px; ***REMOVED***
    body * * ***REMOVED*** padding:0; ***REMOVED***
    body ***REMOVED*** font:small sans-serif; ***REMOVED***
    body>div ***REMOVED*** border-bottom:1px solid #ddd; ***REMOVED***
    h1 ***REMOVED*** font-weight:normal; ***REMOVED***
    h2 ***REMOVED*** margin-bottom:.8em; ***REMOVED***
    h2 span ***REMOVED*** font-size:80%; color:#666; font-weight:normal; ***REMOVED***
    h3 ***REMOVED*** margin:1em 0 .5em 0; ***REMOVED***
    h4 ***REMOVED*** margin:0 0 .5em 0; font-weight: normal; ***REMOVED***
    table ***REMOVED*** border:1px solid #ccc; border-collapse: collapse; width:100%; background:white; ***REMOVED***
    tbody td, tbody th ***REMOVED*** vertical-align:top; padding:2px 3px; ***REMOVED***
    thead th ***REMOVED***
      padding:1px 6px 1px 3px; background:#fefefe; text-align:left;
      font-weight:normal; font-size:11px; border:1px solid #ddd;
    ***REMOVED***
    tbody th ***REMOVED*** width:12em; text-align:right; color:#666; padding-right:.5em; ***REMOVED***
    #summary ***REMOVED*** background: #e0ebff; ***REMOVED***
    #summary h2 ***REMOVED*** font-weight: normal; color: #666; ***REMOVED***
    #explanation ***REMOVED*** background:#eee; ***REMOVED***
    #instructions ***REMOVED*** background:#f6f6f6; ***REMOVED***
    #summary table ***REMOVED*** border:none; background:transparent; ***REMOVED***
  </style>
</head>

<body>
<div id="summary">
  <h1>***REMOVED******REMOVED*** heading ***REMOVED******REMOVED***</h1>
  <h2>***REMOVED******REMOVED*** subheading ***REMOVED******REMOVED***</h2>
</div>

<div id="instructions">
  <p>
    ***REMOVED******REMOVED*** instructions|safe ***REMOVED******REMOVED***
  </p>
</div>

<div id="explanation">
  <p>
    ***REMOVED******REMOVED*** explanation|safe ***REMOVED******REMOVED***
  </p>
</div>
</body></html>
"""
